╔═══════════════════════════════════════════════════════════════════════════════╗
║                   PRODUCTION DEPLOYMENT VISUAL GUIDE                          ║
║                                                                               ║
║  Backend: backbizz.oxodigital.agency                                          ║
║  Frontend: bizz.oxodigital.agency                                             ║
╚═══════════════════════════════════════════════════════════════════════════════╝

┌───────────────────────────────────────────────────────────────────────────────┐
│                        DEPLOYMENT ARCHITECTURE                                │
└───────────────────────────────────────────────────────────────────────────────┘

                   ┌─────────────────────────────────────┐
                   │      bizz.oxodigital.agency         │
                   │         (Frontend - React)          │
                   │   https://bizz.oxodigital.agency    │
                   └──────────────┬──────────────────────┘
                                  │
                                  │ API Calls
                                  ▼
                   ┌─────────────────────────────────────┐
                   │    backbizz.oxodigital.agency       │
                   │      (Backend - Node.js API)        │
                   │  https://backbizz.oxodigital.agency │
                   └──────────────┬──────────────────────┘
                                  │
                                  │ Database Queries
                                  ▼
                   ┌─────────────────────────────────────┐
                   │    nimsleas_bizmanager_main         │
                   │         (MySQL Database)            │
                   │         localhost:3306              │
                   └─────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════
                            PART 1: BACKEND SETUP
═══════════════════════════════════════════════════════════════════════════════

STEP 1: CREATE SUBDOMAIN
┌─────────────────────────────────────────────────────────────────────────────┐
│ cPanel → Subdomains → Create                                                │
│                                                                             │
│ Subdomain: backbizz                                                         │
│ Domain: oxodigital.agency                                                   │
│ Result: backbizz.oxodigital.agency                                          │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 2: SETUP NODE.JS APPLICATION
┌─────────────────────────────────────────────────────────────────────────────┐
│ cPanel → Setup Node.js App → Create Application                            │
│                                                                             │
│ Node.js version: 18.x                                                       │
│ Application mode: Production                                                │
│ Application root: backend                                                   │
│ Application URL: backbizz.oxodigital.agency                                 │
│ Startup file: src/server.js                                                 │
│                                                                             │
│ [Create] button                                                             │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 3: PREPARE BACKEND LOCALLY
┌─────────────────────────────────────────────────────────────────────────────┐
│ On your computer:                                                           │
│                                                                             │
│ 1. Generate JWT secrets:                                                    │
│    node -e "console.log(require('crypto').randomBytes(64).toString('hex'))" │
│                                                                             │
│ 2. Edit backend/.env:                                                       │
│    ┌──────────────────────────────────────────────────────────────────┐   │
│    │ DB_HOST=localhost                                                │   │
│    │ DB_USER=nimsleas_bizmanager_main                                 │   │
│    │ DB_PASSWORD=L&X6e}a=khH&                                         │   │
│    │ DB_NAME=nimsleas_bizmanager_main                                 │   │
│    │ JWT_SECRET=<paste generated secret here>                        │   │
│    │ SUPER_ADMIN_JWT_SECRET=<paste another secret>                   │   │
│    │ PORT=5000                                                        │   │
│    │ NODE_ENV=production                                              │   │
│    │ CORS_ORIGIN=https://bizz.oxodigital.agency                      │   │
│    └──────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│ 3. Create ZIP of backend folder (exclude node_modules)                     │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 4: UPLOAD BACKEND FILES
┌─────────────────────────────────────────────────────────────────────────────┐
│ cPanel → File Manager → /home/username/                                     │
│                                                                             │
│ [Upload] → Select backend.zip → Upload                                      │
│ Right-click backend.zip → [Extract]                                         │
│ Delete backend.zip after extraction                                         │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 5: ADD ENVIRONMENT VARIABLES
┌─────────────────────────────────────────────────────────────────────────────┐
│ cPanel → Setup Node.js App → Click your app → Environment Variables        │
│                                                                             │
│ Add these variables:                                                        │
│ ┌────────────────────────────────┬──────────────────────────────────────┐  │
│ │ Variable Name                  │ Value                                │  │
│ ├────────────────────────────────┼──────────────────────────────────────┤  │
│ │ DB_HOST                        │ localhost                            │  │
│ │ DB_USER                        │ nimsleas_bizmanager_main             │  │
│ │ DB_PASSWORD                    │ L&X6e}a=khH&                         │  │
│ │ DB_NAME                        │ nimsleas_bizmanager_main             │  │
│ │ JWT_SECRET                     │ <your generated secret>              │  │
│ │ SUPER_ADMIN_JWT_SECRET         │ <your other secret>                  │  │
│ │ PORT                           │ 5000                                 │  │
│ │ NODE_ENV                       │ production                           │  │
│ │ CORS_ORIGIN                    │ https://bizz.oxodigital.agency       │  │
│ └────────────────────────────────┴──────────────────────────────────────┘  │
│                                                                             │
│ [Save] after adding each                                                    │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 6: INSTALL DEPENDENCIES
┌─────────────────────────────────────────────────────────────────────────────┐
│ Option A: cPanel Terminal                                                   │
│   Terminal → cd ~/backend → npm install --production                        │
│                                                                             │
│ Option B: Node.js App Manager                                               │
│   Setup Node.js App → Your app → [Run NPM Install]                         │
│                                                                             │
│ ⏳ Wait 2-5 minutes for installation                                        │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 7: SETUP DATABASE TABLES
┌─────────────────────────────────────────────────────────────────────────────┐
│ cPanel → Terminal:                                                          │
│                                                                             │
│ cd ~/backend                                                                │
│ npm run setup-db                                                            │
│                                                                             │
│ Expected output:                                                            │
│ ✅ Main database tables created successfully                                │
│ ✅ Subscription database tables created successfully                        │
│ ✅ HR database tables created successfully                                  │
│                                                                             │
│ Verify in phpMyAdmin:                                                       │
│ - subscription_plans (4 records)                                            │
│ - tenants, tenant_users, subscriptions, etc.                                │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 8: CREATE SUPER ADMIN
┌─────────────────────────────────────────────────────────────────────────────┐
│ Terminal:                                                                   │
│                                                                             │
│ npm run create-super-admin                                                  │
│                                                                             │
│ Enter:                                                                      │
│ - Email: admin@oxodigital.agency                                            │
│ - Password: <strong password>                                               │
│ - Full Name: Super Administrator                                            │
│ - Role: super_admin                                                         │
│                                                                             │
│ 💾 Save these credentials securely!                                         │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 9: START BACKEND APPLICATION
┌─────────────────────────────────────────────────────────────────────────────┐
│ cPanel → Setup Node.js App → Your application                              │
│                                                                             │
│ Status: Running ✅                                                          │
│                                                                             │
│ If stopped: Click [Start App]                                               │
│ If running: Click [Restart]                                                 │
│                                                                             │
│ Check logs for errors: [Open logs] / [View logs]                           │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 10: INSTALL SSL CERTIFICATE
┌─────────────────────────────────────────────────────────────────────────────┐
│ cPanel → SSL/TLS Status                                                     │
│                                                                             │
│ Find: backbizz.oxodigital.agency                                            │
│ Click: [Run AutoSSL]                                                        │
│                                                                             │
│ ⏳ Wait 1-2 minutes                                                         │
│                                                                             │
│ Result: 🔒 Green padlock next to domain                                    │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 11: TEST BACKEND
┌─────────────────────────────────────────────────────────────────────────────┐
│ Open in browser:                                                            │
│                                                                             │
│ 1. https://backbizz.oxodigital.agency/api/health                            │
│    Expected: {"status":"OK","message":"..."}                                │
│                                                                             │
│ 2. https://backbizz.oxodigital.agency/api/subscriptions/plans               │
│    Expected: {"plans":[...]} with 4 plans                                   │
│                                                                             │
│ ✅ If both work → Backend deployed successfully!                            │
│ ❌ If errors → Check logs and troubleshoot                                  │
└─────────────────────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════
                           PART 2: FRONTEND SETUP
═══════════════════════════════════════════════════════════════════════════════

STEP 12: CONFIGURE FRONTEND
┌─────────────────────────────────────────────────────────────────────────────┐
│ On your computer:                                                           │
│                                                                             │
│ Create: frontend/.env.production                                            │
│ ┌──────────────────────────────────────────────────────────────────────┐  │
│ │ REACT_APP_API_URL=https://backbizz.oxodigital.agency/api            │  │
│ └──────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│ ⚠️  Important: No trailing slash!                                          │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 13: BUILD FRONTEND
┌─────────────────────────────────────────────────────────────────────────────┐
│ Open terminal on your computer:                                             │
│                                                                             │
│ cd frontend                                                                 │
│ npm install                                                                 │
│ npm run build                                                               │
│                                                                             │
│ ⏳ Wait for build to complete (1-3 minutes)                                │
│                                                                             │
│ Result: build/ folder created with optimized files                         │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 14: UPLOAD FRONTEND FILES
┌─────────────────────────────────────────────────────────────────────────────┐
│ cPanel → File Manager → /public_html                                        │
│                                                                             │
│ 1. Backup existing files (if any)                                           │
│ 2. Clear the directory                                                      │
│ 3. Upload ALL contents from frontend/build/:                                │
│    - index.html                                                             │
│    - static/ folder                                                         │
│    - asset-manifest.json                                                    │
│    - manifest.json                                                          │
│    - favicon.ico                                                            │
│    - robots.txt                                                             │
│                                                                             │
│ OR: Upload build.zip and extract                                            │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 15: CREATE .htaccess
┌─────────────────────────────────────────────────────────────────────────────┐
│ File Manager → /public_html → Create new file: .htaccess                    │
│                                                                             │
│ Edit .htaccess and paste:                                                   │
│ ┌──────────────────────────────────────────────────────────────────────┐  │
│ │ <IfModule mod_rewrite.c>                                             │  │
│ │   RewriteEngine On                                                   │  │
│ │   RewriteBase /                                                      │  │
│ │   RewriteCond %{REQUEST_FILENAME} !-f                                │  │
│ │   RewriteCond %{REQUEST_FILENAME} !-d                                │  │
│ │   RewriteRule . /index.html [L]                                      │  │
│ │ </IfModule>                                                          │  │
│ │                                                                      │  │
│ │ <IfModule mod_rewrite.c>                                             │  │
│ │   RewriteEngine On                                                   │  │
│ │   RewriteCond %{HTTPS} off                                           │  │
│ │   RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]   │  │
│ │ </IfModule>                                                          │  │
│ └──────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│ [Save Changes]                                                              │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 16: INSTALL SSL FOR FRONTEND
┌─────────────────────────────────────────────────────────────────────────────┐
│ cPanel → SSL/TLS Status                                                     │
│                                                                             │
│ Find: bizz.oxodigital.agency                                                │
│ Click: [Run AutoSSL]                                                        │
│                                                                             │
│ ⏳ Wait 1-2 minutes                                                         │
│                                                                             │
│ Result: 🔒 Green padlock                                                   │
└─────────────────────────────────────────────────────────────────────────────┘


STEP 17: TEST FRONTEND
┌─────────────────────────────────────────────────────────────────────────────┐
│ Open in browser:                                                            │
│                                                                             │
│ 1. https://bizz.oxodigital.agency                                           │
│    ✅ React app loads                                                       │
│    ✅ HTTPS padlock visible                                                 │
│    ✅ No console errors (F12)                                               │
│                                                                             │
│ 2. https://bizz.oxodigital.agency/plans                                     │
│    ✅ 4 subscription plans visible                                          │
│                                                                             │
│ 3. Test page refresh (F5) on different routes                              │
│    ✅ No 404 errors                                                         │
└─────────────────────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════
                          FINAL VERIFICATION
═══════════════════════════════════════════════════════════════════════════════

TEST COMPLETE FLOW
┌─────────────────────────────────────────────────────────────────────────────┐
│ 1. Visit: https://bizz.oxodigital.agency/plans                             │
│    ✅ 4 subscription plan cards visible                                     │
│                                                                             │
│ 2. Click "Start Free Trial" on any plan                                     │
│    ✅ Signup form opens                                                     │
│                                                                             │
│ 3. Fill signup form:                                                        │
│    - Tenant Name: Test Company                                              │
│    - Email: test@example.com                                                │
│    - Password: Test123!                                                     │
│    - Owner Name: Test User                                                  │
│    ✅ Form submits                                                          │
│                                                                             │
│ 4. After signup:                                                            │
│    ✅ Account created successfully                                          │
│    ✅ Auto-logged in                                                        │
│    ✅ Redirected to dashboard                                               │
│                                                                             │
│ 5. Check database (phpMyAdmin):                                             │
│    ✅ Record in tenants table                                               │
│    ✅ Record in tenant_users table                                          │
│    ✅ New database created (biz_test-company-...)                           │
│                                                                             │
│ 6. Test super admin login:                                                  │
│    Visit: https://bizz.oxodigital.agency/super-admin/login                 │
│    ✅ Login with admin credentials works                                    │
│    ✅ Super admin dashboard loads                                           │
│                                                                             │
│ 🎉 ALL TESTS PASSED → DEPLOYMENT SUCCESSFUL!                               │
└─────────────────────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════
                           TROUBLESHOOTING GUIDE
═══════════════════════════════════════════════════════════════════════════════

PROBLEM: Backend shows 503 error
┌─────────────────────────────────────────────────────────────────────────────┐
│ Solutions:                                                                  │
│ 1. Check Node.js app status → Should be "Running"                          │
│ 2. Click "Restart" in Node.js App Manager                                   │
│ 3. View logs for specific errors                                            │
│ 4. Verify npm install completed                                             │
│ 5. Check startup file path is correct                                       │
└─────────────────────────────────────────────────────────────────────────────┘

PROBLEM: CORS errors in browser
┌─────────────────────────────────────────────────────────────────────────────┐
│ Solutions:                                                                  │
│ 1. Check CORS_ORIGIN in environment variables                               │
│ 2. Must be: https://bizz.oxodigital.agency (exact match)                    │
│ 3. Restart backend after changing                                           │
│ 4. Clear browser cache                                                      │
└─────────────────────────────────────────────────────────────────────────────┘

PROBLEM: Plans not loading
┌─────────────────────────────────────────────────────────────────────────────┐
│ Solutions:                                                                  │
│ 1. Verify backend is running                                                │
│ 2. Test API directly: /api/subscriptions/plans                              │
│ 3. Check database has subscription_plans table with 4 records               │
│ 4. Run npm run setup-db if tables missing                                   │
│ 5. Check browser console for specific errors                                │
└─────────────────────────────────────────────────────────────────────────────┘

PROBLEM: 404 on page refresh
┌─────────────────────────────────────────────────────────────────────────────┐
│ Solutions:                                                                  │
│ 1. Check .htaccess exists in /public_html                                   │
│ 2. Verify .htaccess has rewrite rules                                       │
│ 3. Check file permissions: 644                                              │
│ 4. mod_rewrite should be enabled (usually is)                               │
└─────────────────────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════
                             SUCCESS SUMMARY
═══════════════════════════════════════════════════════════════════════════════

✅ Backend deployed:    https://backbizz.oxodigital.agency
✅ Frontend deployed:   https://bizz.oxodigital.agency  
✅ Database setup:      nimsleas_bizmanager_main
✅ SSL certificates:    Installed and active
✅ Super admin:         Created and tested
✅ Signup flow:         Working correctly
✅ API endpoints:       All functional
✅ CORS configured:     Frontend ↔ Backend communication working

🎉 DEPLOYMENT COMPLETE! 🎉

Your Business Management System is now LIVE and ready for production use!

═══════════════════════════════════════════════════════════════════════════════

For detailed instructions, see: PRODUCTION_DEPLOYMENT_GUIDE.md
For quick checklist, see: DEPLOYMENT_QUICK_CHECKLIST.md

